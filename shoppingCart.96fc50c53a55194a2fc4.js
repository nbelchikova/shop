(()=>{"use strict";var e={580:(e,t,o)=>{o.r(t)},200:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addEventListenerToCartProduct=t.updateHeaderTotal=t.removeProductFromCart=t.addProductToCart=t.isProductInCart=t.getWordWithEnding=t.addToQueryParams=t.createElement=void 0,t.createElement=(e,t,o,n)=>{const r=document.createElement(e);return t.appendChild(r),o&&r.classList.add(...o),n&&(r.innerHTML=n),r},t.addToQueryParams=(e,t)=>{const o=new URL(window.location.href);o.searchParams.set(e,t),window.history.replaceState(null,"",o)},t.getWordWithEnding=(e,t)=>1===e?t:`${t}s`,t.isProductInCart=e=>[...localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")||""):[]].findIndex((({productId:t})=>e===t))>=0,t.addProductToCart=e=>{const t=[...localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")||""):[],e];localStorage.setItem("cart",JSON.stringify(t))},t.removeProductFromCart=e=>{const t=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")||""):[],o=[...t].findIndex((({id:t})=>t===e.id)),n=[...t.slice(0,o),...t.slice(o+1,t.length)];localStorage.setItem("cart",JSON.stringify(n))},t.updateHeaderTotal=()=>{const e=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")||""):[],t=document.querySelector(".header-total"),o=document.querySelector(".header-cart-quantity"),n=e.reduce(((e,t)=>e+t.cost),0),r=e.length;t.innerText=`Общая сумма: ${n} руб.`,o.innerText=String(r)},t.addEventListenerToCartProduct=(e,o)=>{e.addEventListener("click",(()=>{"Добавить в корзину"===e.innerText?((0,t.addProductToCart)(o),e.innerText="Удалить из корзины",e.classList.toggle("btn-remove"),(0,t.updateHeaderTotal)()):((0,t.removeProductFromCart)(o),e.innerText="Добавить в корзину",e.classList.toggle("btn-remove"),(0,t.updateHeaderTotal)()),localStorage.removeItem("block")}))}},538:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.routeCart=t.routeMain=t.routeGood=void 0,t.routeGood="goods.html",t.routeMain="index.html",t.routeCart="shoppingCart.html"},684:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCartItem=void 0;const n=o(200),r=o(28),a=o(157);t.addCartItem=(e,t,o)=>{document.querySelector(".products-in-cart").insertAdjacentHTML("beforeend",`\n  <div class="product-wrapper">\n        <div class="products-details" id=details-of-${e.id}>\n          <div>\n            <p class="product-name">${o}. ${e.name}</p>\n            <p class="product-info">Категория: ${e.category}</p>\n            <p class="product-info">\n            Остаток на складе: ${e.warehouse} шт.\n            </p>\n            <p class="product-info">\n            Сумма: ${e.cost} руб.\n            </p>\n\n          </div>\n        </div>\n        <div class="product-details">\n          <div class="products-counter" id='counter-for-${e.id}'>\n          </div>\n          <div class="image-wrapper">\n            <img class="product-photo" src=${e.image1} alt="Ничего не получилось" />\n          </div>\n        </div>\n      </div>`);const c=document.querySelector(`#details-of-${e.id}`),d=document.querySelector(`#counter-for-${e.id}`),i=document.createElement("button");i.classList.add("square-button"),i.innerText="+",null==d||d.appendChild(i);const l=document.createElement("p");l.innerText=String(t),null==d||d.appendChild(l);const s=document.createElement("button");s.classList.add("square-button"),s.innerText="-",null==d||d.appendChild(s);const u=document.createElement("p");u.classList.add("product-info"),u.innerText=`Общая сумма: ${e.cost*t}  руб.`,null==c||c.appendChild(u),null==i||i.addEventListener("click",(()=>{if(+l.innerText!==e.warehouse){(0,n.addProductToCart)(e),l.innerText=String(+l.innerText+1);const t=+u.innerText.split(" ")[2];u.innerText=`Общая сумма: ${e.cost+t}  руб.`,(0,a.updateTotalAfterCount)("plus",e.cost)}})),null==s||s.addEventListener("click",(()=>{if((0,n.removeProductFromCart)(e),1==+l.innerText)(0,r.paginationInit)();else{l.innerText=String(+l.innerText-1);const t=+u.innerText.split(" ")[2];u.innerText=`Общая сумма: ${t-e.cost}  руб.`,(0,a.updateTotalAfterCount)("minus",e.cost)}}))}},878:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getItemsFromStorage=void 0,t.getItemsFromStorage=()=>{const e=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")||""):[],t=e.reduce(((e,t)=>e[t.id]?Object.assign(Object.assign({},e),{[t.id]:e[t.id]+1}):Object.assign(Object.assign({},e),{[t.id]:1})),{});return Object.entries(t).map((([t,o])=>[e.find((e=>e.id===+t)),o]))}},28:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paginationInit=void 0;const n=o(200),r=o(878),a=o(370),c=document.querySelector(".pagination__secondary-text"),d=document.querySelector("#page"),i=document.querySelector("#page-number"),l=document.querySelector("#items-per-page"),s=document.querySelectorAll(".pagination__select"),u=document.querySelector(".pagination__left-arrow"),p=document.querySelector(".pagination__right-arrow"),m=document.querySelector("#page-options");let g;const v=()=>{const e=(0,r.getItemsFromStorage)().length,t=document.querySelector(".products-in-cart");let o=+(null==d?void 0:d.innerText);o>g&&(d.innerText=String(g),o=+(null==d?void 0:d.innerText));const s=+(null==l?void 0:l.innerText),v=+(o*s-(s-1)),y=v+(s-1)<=e?v+(s-1):e;g=Math.ceil(e/s),t.innerHTML="",(0,a.renderCartItems)(v,y),(0,n.addToQueryParams)("page",String(o)),(0,n.addToQueryParams)("items-per-page",String(s)),i.innerText=`of ${g} ${(0,n.getWordWithEnding)(g,"page")}`,c.innerText=1===s||y===v?`Showing ${v} of ${e} items`:`Showing ${v}-${y} of ${e} ${(0,n.getWordWithEnding)(e,"item")}`,m.innerHTML="";for(let e=0;e<g;e++)m.insertAdjacentHTML("beforeend",`<li class="pagination__option">${e+1}</li>`);1===o?u.classList.add("disabled"):u.classList.remove("disabled"),o===g?p.classList.add("disabled"):p.classList.remove("disabled")};t.paginationInit=()=>{const e=(0,r.getItemsFromStorage)().length,t=new URLSearchParams(window.location.search),o=t.get("page")||1,n=t.get("items-per-page")||3;l.innerText=String(n),d.innerText=String(o),g=e/3,v(),s.forEach((e=>{const t=e.querySelector(".pagination__options-wrapper"),o=e.querySelector(".pagination__selected");e.addEventListener("click",(()=>{e.classList.toggle("active")})),t.addEventListener("click",(e=>{const t=e.target;(null==t?void 0:t.classList.contains("pagination__option"))&&(o.innerHTML=t.innerText,v())}))})),u.addEventListener("click",(()=>{const e=+d.innerText;1!==e&&(d.innerText=""+(e-1),v())})),p.addEventListener("click",(()=>{const e=+d.innerText;e+1<=g&&(d.innerText=`${e+1}`,v())}))}},739:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.discount=t.promo=t.promocode=t.promoInfo=t.promoInput=void 0,t.promoInput=document.querySelector("#promo-input"),t.promoInfo=document.querySelector(".promo-info");const o=document.querySelector(".promo-form"),n=document.querySelector(".total-price"),r=document.querySelector(".discount-price"),a=document.querySelector("#promo-apply");function c(){t.promocode.includes(t.promoInput.value)&&(t.promoInfo.textContent=`${t.promoInput.value}. Скидка 10%`)}function d(){var e;const t=document.querySelectorAll("#promo-apply p");if(t.length){const o=Number(null===(e=n.textContent)||void 0===e?void 0:e.split(" ")[0])*(100-10*t.length)/100;r.textContent=`${o} руб`,n.classList.add("price-discount")}else r.textContent=`${n.textContent}`,n.classList.remove("price-discount")}function i(){const e=document.querySelectorAll("#promo-apply p");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(()=>{e[t].remove(),d()}))}t.promocode=["promo1","promo2","promo3"],t.promo=c,t.promoInput.addEventListener("input",c,!1),t.discount=d,o.addEventListener("submit",(function(e){e.preventDefault(),function(){const e=document.querySelectorAll("#promo-apply p");if("promo1"===t.promoInput.value||"promo2"===t.promoInput.value||"promo3"===t.promoInput.value)if(0===e.length){const e=document.createElement("p");a.append(e),e.textContent=`-${t.promoInput.value}. Скидка 10% (Удалить)`,d(),i()}else{for(let o=0;o<e.length;o++)if(e[o].textContent===`-${t.promoInput.value}. Скидка 10% (Удалить)`)return;const o=document.createElement("p");a.append(o),o.textContent=`-${t.promoInput.value}. Скидка 10% (Удалить)`,d(),i()}}()}),!1)},370:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderCartItems=void 0;const n=o(684),r=o(878),a=o(157),c=document.querySelector(".main");t.renderCartItems=(e,t)=>{const o=(0,r.getItemsFromStorage)();console.log(o,e,t);const d=o.slice(e-1,t);document.querySelector(".products-in-cart").innerHTML="",o.length||(c.innerHTML="",c.insertAdjacentHTML("beforeend","<div class='empty-cart'>\n        <p>Здесь пока ничего нет :(</p>\n        <img src=\"/christmas-wreath-2300222.png\">\n      </div>")),d.forEach((([t,o],r)=>{t&&(0,n.addCartItem)(t,o,e+r)}));const i=o.reduce(((e,[t,o])=>(null==t?void 0:t.cost)?e+(null==t?void 0:t.cost)*o:e),0),l=o.reduce(((e,[t,o])=>e+o),0);(0,a.updateTotal)(i,l)}},157:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTotalAfterCount=t.updateTotal=void 0;const n=o(200),r=o(739),a=document.querySelector(".total-price"),c=document.querySelector(".total-quantity");t.updateTotal=(e,t)=>{a.innerHTML=`${e} руб.`,c.innerHTML=`${t} шт.`,(0,r.discount)()},t.updateTotalAfterCount=(e,o)=>{const r=+a.innerText.split(" ")[0],d=+c.innerText.split(" ")[0];"plus"===e?(0,t.updateTotal)(r+o,d+1):(0,t.updateTotal)(r-o,d-1),(0,n.updateHeaderTotal)()}},990:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.modifyInput=t.dateExp=void 0;const n=o(538),r=document.querySelector(".formes"),a=document.querySelector(".formes-card"),c=document.querySelector(".end-order-wrapper"),d=document.querySelector(".field-container img");r.addEventListener("submit",(function(e){r.style.display="none",a.style.display="block",e.preventDefault()}),!1),t.dateExp=document.querySelector("#expirationdate"),t.modifyInput=function(){2===t.dateExp.value.length?t.dateExp.value+="/":3===t.dateExp.value.length&&"/"===t.dateExp.value.charAt(2)&&(t.dateExp.value=t.dateExp.value.replace("/",""))},t.dateExp.addEventListener("input",t.modifyInput,!1),a.addEventListener("submit",(function(e){a.style.display="none",c.style.display="block",e.preventDefault(),setTimeout((()=>{window.location.href=n.routeMain}),4e3)}),!1);const i=document.querySelector("#cardnumber");i.addEventListener("input",(function(){"3"===i.value[0]&&(d.src="./AmericanExpress.jpg"),"4"===i.value[0]&&(d.src="./Visa.png"),"5"===i.value[0]&&(d.src="./MasterCard.png")}),!1)}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{o(580);const e=o(28);o(739),o(990);const t=o(200);(0,e.paginationInit)(),(0,t.updateHeaderTotal)();const n=document.querySelector(".formes");n.style.display="none",localStorage.getItem("block")?n.style.display="block":n.style.display="none";const r=document.querySelector(".btn-close"),a=document.querySelector(".btn-close-container"),c=document.querySelector(".formes-container");r.addEventListener("click",(()=>{n.style.display="none"})),a.addEventListener("click",(()=>{c.style.display="none"})),document.querySelector(".order-button").addEventListener("click",(()=>{n.style.display="block"}))})()})();
//# sourceMappingURL=shoppingCart.96fc50c53a55194a2fc4.js.map